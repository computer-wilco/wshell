<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux Terminal</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="xterm.css">
    <script src="xterm.js" type="text/javascript"></script>
    <script src="addon-fit.js" type="text/javascript"></script>
</head>
<body>
    <div id='xterminal-box'>
        <div id='xterminal'></div>
    </div>
    <script>
        function loadTerminal() {
            var theme = {
                foreground: '#F8F8F8',
                background: '#2D2E2C',
                selection: '#5DA5D533',
                black: '#1E1E1D',
                brightBlack: '#262625',
                red: '#CE5C5C',
                brightRed: '#FF7272',
                green: '#5BCC5B',
                brightGreen: '#72FF72',
                yellow: '#CCCC5B',
                brightYellow: '#FFFF72',
                blue: '#5D5DD3',
                brightBlue: '#7279FF',
                magenta: '#BC5ED1',
                brightMagenta: '#E572FF',
                cyan: '#5DA5D5',
                brightCyan: '#72F0FF',
                white: '#F8F8F8',
                brightWhite: '#FFFFFF'
            };

            var fitAddon = new window.FitAddon.FitAddon();

            var term = new window.Terminal({
                fontFamily: '"Cascadia Code", Menlo, monospace',
                fontWeight: 'bold',
                fontSize: 15,
                theme: theme,
                cursorBlink: true,
                allowProposedApi: true
            });

            term.loadAddon(fitAddon);

            term.open(document.getElementById('xterminal'));

            fitAddon.fit();

            window.addEventListener('resize', () => {
                fitAddon.fit();
            });

            term._initialized = true;

            window.electron.startTerminal();

            window.electron.onCommandOutput((output) => {
                term.write(output);
            });

            function executeCommand(command) {
                window.electron.executeCommand(command);
            }

            term.reset();
            executeCommand('sh -c "$(cat ' + window.electron.dirname() + '/doedingen.sh)"\r');
            term.write("\x1b[31;1mWelkom \x1b[33;1mbij \x1b[34mde \x1b[32m\x1b[3mW-shell\x1b[0m\x1b[0m\r\n");
            term.write("\r\nExecute command: \x1b[3mbash\x1b[0m\r\n\r\n");

            term.onData((data) => {
                if (data === '\r') { // Als Enter wordt ingedrukt, voer het commando uit
                    executeCommand('\r'); // Ga naar de volgende regel
                } else if (data === '\u007f') {  // Backspace wordt ingedrukt
                    // Verwijder het laatste karakter van de invoer
                    executeCommand('\b \b');  // Verwijder het laatste karakter in de terminal
                } else if (data === '\u0003') {
                    executeCommand('\u0003');
                } else {
                    // Voeg de geklikte toets toe aan de invoer
                    executeCommand(data);  // Schrijf het in de terminal
                }
            });
        }

        loadTerminal();
    </script>
</body>
</html>